// Generated by psc version 0.9.3
"use strict";
var Prelude = require("../Prelude");
var Data_Array = require("../Data.Array");
var Data_Identity = require("../Data.Identity");
var Data_Lens_Internal_Wander = require("../Data.Lens.Internal.Wander");
var Data_Lens_Types = require("../Data.Lens.Types");
var Data_Map = require("../Data.Map");
var Data_Maybe = require("../Data.Maybe");
var Data_Set = require("../Data.Set");
var Data_StrMap = require("../Data.StrMap");
var Data_Traversable = require("../Data.Traversable");
var Data_Functor = require("../Data.Functor");
var Data_Eq = require("../Data.Eq");
var Data_Function = require("../Data.Function");
var Control_Applicative = require("../Control.Applicative");
var Control_Semigroupoid = require("../Control.Semigroupoid");
var Index = function (ix) {
    this.ix = ix;
};
var ix = function (dict) {
    return dict.ix;
};
var indexStrMap = new Index(function (k) {
    return function (dictWander) {
        return Data_Lens_Internal_Wander.wander(dictWander)(function (dictApplicative) {
            return function (coalg) {
                return function (m) {
                    return Data_Function.applyFlipped(Data_StrMap.lookup(k)(m))(Data_Maybe.maybe(Control_Applicative.pure(dictApplicative)(m))(function ($20) {
                        return Data_Functor.map((dictApplicative["__superclass_Control.Apply.Apply_0"]())["__superclass_Data.Functor.Functor_0"]())(function (v) {
                            return Data_StrMap.insert(k)(v)(m);
                        })(coalg($20));
                    }));
                };
            };
        });
    };
});
var indexSet = function (dictOrd) {
    return new Index(function (x) {
        return function (dictWander) {
            return Data_Lens_Internal_Wander.wander(dictWander)(function (dictApplicative) {
                return function (coalg) {
                    return function ($21) {
                        return Control_Applicative.pure(dictApplicative)(Data_Set.insert(dictOrd)(x)($21));
                    };
                };
            });
        };
    });
};
var indexMaybe = new Index(function (v) {
    return function (dictWander) {
        return Data_Lens_Internal_Wander.wander(dictWander)(function (dictApplicative) {
            return Data_Traversable.traverse(Data_Traversable.traversableMaybe)(dictApplicative);
        });
    };
});
var indexMap = function (dictOrd) {
    return new Index(function (k) {
        return function (dictWander) {
            return Data_Lens_Internal_Wander.wander(dictWander)(function (dictApplicative) {
                return function (coalg) {
                    return function (m) {
                        return Data_Function.applyFlipped(Data_Map.lookup(dictOrd)(k)(m))(Data_Maybe.maybe(Control_Applicative.pure(dictApplicative)(m))(function ($22) {
                            return Data_Functor.map((dictApplicative["__superclass_Control.Apply.Apply_0"]())["__superclass_Data.Functor.Functor_0"]())(function (v) {
                                return Data_Map.insert(dictOrd)(k)(v)(m);
                            })(coalg($22));
                        }));
                    };
                };
            });
        };
    });
};
var indexIdentity = new Index(function (v) {
    return function (dictWander) {
        return Data_Lens_Internal_Wander.wander(dictWander)(function (dictApplicative) {
            return Data_Traversable.traverse(Data_Identity.traversableIdentity)(dictApplicative);
        });
    };
});
var indexArray = new Index(function (n) {
    return function (dictWander) {
        return Data_Lens_Internal_Wander.wander(dictWander)(function (dictApplicative) {
            return function (coalg) {
                return function (xs) {
                    return Data_Function.applyFlipped(Data_Array.index(xs)(n))(Data_Maybe.maybe(Control_Applicative.pure(dictApplicative)(xs))(function ($23) {
                        return Data_Functor.map((dictApplicative["__superclass_Control.Apply.Apply_0"]())["__superclass_Data.Functor.Functor_0"]())(function (x) {
                            return Data_Maybe.fromMaybe(xs)(Data_Array.updateAt(n)(x)(xs));
                        })(coalg($23));
                    }));
                };
            };
        });
    };
});
var indexArr = function (dictEq) {
    return new Index(function (i) {
        return function (dictWander) {
            return Data_Lens_Internal_Wander.wander(dictWander)(function (dictApplicative) {
                return function (coalg) {
                    return function (f) {
                        return Data_Functor.mapFlipped((dictApplicative["__superclass_Control.Apply.Apply_0"]())["__superclass_Data.Functor.Functor_0"]())(coalg(f(i)))(function (a) {
                            return function (j) {
                                var $19 = Data_Eq.eq(dictEq)(i)(j);
                                if ($19) {
                                    return a;
                                };
                                if (!$19) {
                                    return f(j);
                                };
                                throw new Error("Failed pattern match at Data.Lens.Index line 25, column 9 - line 25, column 34: " + [ $19.constructor.name ]);
                            };
                        });
                    };
                };
            });
        };
    });
};
module.exports = {
    Index: Index, 
    ix: ix, 
    indexArr: indexArr, 
    indexMaybe: indexMaybe, 
    indexIdentity: indexIdentity, 
    indexArray: indexArray, 
    indexSet: indexSet, 
    indexMap: indexMap, 
    indexStrMap: indexStrMap
};

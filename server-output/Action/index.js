// Generated by psc version 0.9.3
"use strict";
var Prelude = require("../Prelude");
var Data_Argonaut = require("../Data.Argonaut");
var Data_FormURLEncoded = require("../Data.FormURLEncoded");
var Data_Maybe = require("../Data.Maybe");
var Data_Either = require("../Data.Either");
var Data_Foreign = require("../Data.Foreign");
var Data_Foreign_Generic = require("../Data.Foreign.Generic");
var Data_Tuple = require("../Data.Tuple");
var Data_Foreign_Class = require("../Data.Foreign.Class");
var Control_Monad_Aff = require("../Control.Monad.Aff");
var Control_Monad_Eff_Console = require("../Control.Monad.Eff.Console");
var Network_HTTP_Affjax = require("../Network.HTTP.Affjax");
var Network_HTTP_RequestHeader = require("../Network.HTTP.RequestHeader");
var Data_HTTP_Method = require("../Data.HTTP.Method");
var Data_MediaType_Common = require("../Data.MediaType.Common");
var Network_HTTP_StatusCode = require("../Network.HTTP.StatusCode");
var Control_Monad_Eff_Class = require("../Control.Monad.Eff.Class");
var DOM = require("../DOM");
var Pux = require("../Pux");
var Pux_Html_Events = require("../Pux.Html.Events");
var Pux_Router = require("../Pux.Router");
var Route = require("../Route");
var Model = require("../Model");
var App = require("../App");
var Text_Parsing_StringParser = require("../Text.Parsing.StringParser");
var Fullscreen = require("../Fullscreen");
var Data_Argonaut_Encode_Class = require("../Data.Argonaut.Encode.Class");
var Data_Argonaut_Encode_Combinators = require("../Data.Argonaut.Encode.Combinators");
var Data_Argonaut_Core = require("../Data.Argonaut.Core");
var Data_Function = require("../Data.Function");
var Control_Semigroupoid = require("../Control.Semigroupoid");
var Data_Show = require("../Data.Show");
var Control_Bind = require("../Control.Bind");
var Control_Applicative = require("../Control.Applicative");
var Data_HeytingAlgebra = require("../Data.HeytingAlgebra");
var Network_HTTP_Affjax_Request = require("../Network.HTTP.Affjax.Request");
var Network_HTTP_Affjax_Response = require("../Network.HTTP.Affjax.Response");
var Data_Semigroup = require("../Data.Semigroup");
var Data_Eq = require("../Data.Eq");
var SearchChange = (function () {
    function SearchChange(value0) {
        this.value0 = value0;
    };
    SearchChange.create = function (value0) {
        return new SearchChange(value0);
    };
    return SearchChange;
})();
var NewSongChange = (function () {
    function NewSongChange(value0) {
        this.value0 = value0;
    };
    NewSongChange.create = function (value0) {
        return new NewSongChange(value0);
    };
    return NewSongChange;
})();
var UpdateSongChange = (function () {
    function UpdateSongChange(value0) {
        this.value0 = value0;
    };
    UpdateSongChange.create = function (value0) {
        return new UpdateSongChange(value0);
    };
    return UpdateSongChange;
})();
var MkSongFullscreen = (function () {
    function MkSongFullscreen() {

    };
    MkSongFullscreen.value = new MkSongFullscreen();
    return MkSongFullscreen;
})();
var ToggleShowSongMeta = (function () {
    function ToggleShowSongMeta() {

    };
    ToggleShowSongMeta.value = new ToggleShowSongMeta();
    return ToggleShowSongMeta;
})();
var ToggleShowDuplicatedChorus = (function () {
    function ToggleShowDuplicatedChorus() {

    };
    ToggleShowDuplicatedChorus.value = new ToggleShowDuplicatedChorus();
    return ToggleShowDuplicatedChorus;
})();
var PostSong = function (x) {
    return x;
};
var Ok = (function () {
    function Ok() {

    };
    Ok.value = new Ok();
    return Ok;
})();
var Ko = (function () {
    function Ko(value0) {
        this.value0 = value0;
    };
    Ko.create = function (value0) {
        return new Ko(value0);
    };
    return Ko;
})();
var RequestSong = (function () {
    function RequestSong(value0) {
        this.value0 = value0;
    };
    RequestSong.create = function (value0) {
        return new RequestSong(value0);
    };
    return RequestSong;
})();
var ReceiveSong = (function () {
    function ReceiveSong(value0) {
        this.value0 = value0;
    };
    ReceiveSong.create = function (value0) {
        return new ReceiveSong(value0);
    };
    return ReceiveSong;
})();
var RequestSearch = (function () {
    function RequestSearch(value0) {
        this.value0 = value0;
    };
    RequestSearch.create = function (value0) {
        return new RequestSearch(value0);
    };
    return RequestSearch;
})();
var ReceiveSearch = (function () {
    function ReceiveSearch(value0) {
        this.value0 = value0;
    };
    ReceiveSearch.create = function (value0) {
        return new ReceiveSearch(value0);
    };
    return ReceiveSearch;
})();
var SubmitNewSong = (function () {
    function SubmitNewSong() {

    };
    SubmitNewSong.value = new SubmitNewSong();
    return SubmitNewSong;
})();
var SubmitUpdateSong = (function () {
    function SubmitUpdateSong() {

    };
    SubmitUpdateSong.value = new SubmitUpdateSong();
    return SubmitUpdateSong;
})();
var SubmitDeleteSong = (function () {
    function SubmitDeleteSong(value0) {
        this.value0 = value0;
    };
    SubmitDeleteSong.create = function (value0) {
        return new SubmitDeleteSong(value0);
    };
    return SubmitDeleteSong;
})();
var ReceiveSubmitNewSong = (function () {
    function ReceiveSubmitNewSong(value0) {
        this.value0 = value0;
    };
    ReceiveSubmitNewSong.create = function (value0) {
        return new ReceiveSubmitNewSong(value0);
    };
    return ReceiveSubmitNewSong;
})();
var ReceiveSubmitUpdateSong = (function () {
    function ReceiveSubmitUpdateSong(value0, value1) {
        this.value0 = value0;
        this.value1 = value1;
    };
    ReceiveSubmitUpdateSong.create = function (value0) {
        return function (value1) {
            return new ReceiveSubmitUpdateSong(value0, value1);
        };
    };
    return ReceiveSubmitUpdateSong;
})();
var ReceiveSubmitDeleteSong = (function () {
    function ReceiveSubmitDeleteSong(value0) {
        this.value0 = value0;
    };
    ReceiveSubmitDeleteSong.create = function (value0) {
        return new ReceiveSubmitDeleteSong(value0);
    };
    return ReceiveSubmitDeleteSong;
})();
var IOAction = (function () {
    function IOAction(value0) {
        this.value0 = value0;
    };
    IOAction.create = function (value0) {
        return new IOAction(value0);
    };
    return IOAction;
})();
var UIAction = (function () {
    function UIAction(value0) {
        this.value0 = value0;
    };
    UIAction.create = function (value0) {
        return new UIAction(value0);
    };
    return UIAction;
})();
var PageView = (function () {
    function PageView(value0) {
        this.value0 = value0;
    };
    PageView.create = function (value0) {
        return new PageView(value0);
    };
    return PageView;
})();
var Noop = (function () {
    function Noop() {

    };
    Noop.value = new Noop();
    return Noop;
})();
var updateUI = function (v) {
    return function (v1) {
        if (v instanceof SearchChange) {
            return Data_Function.apply(Pux.noEffects)((function () {
                var $25 = {};
                for (var $26 in v1) {
                    if (v1.hasOwnProperty($26)) {
                        $25[$26] = v1[$26];
                    };
                };
                $25.ui = (function () {
                    var $22 = {};
                    for (var $23 in v1.ui) {
                        if (v1.ui.hasOwnProperty($23)) {
                            $22[$23] = v1.ui[$23];
                        };
                    };
                    $22.searchQuery = v.value0.target.value;
                    return $22;
                })();
                return $25;
            })());
        };
        if (v instanceof NewSongChange) {
            return Data_Function.apply(Pux.noEffects)((function () {
                var $32 = {};
                for (var $33 in v1) {
                    if (v1.hasOwnProperty($33)) {
                        $32[$33] = v1[$33];
                    };
                };
                $32.io = {
                    song: v1.io.song, 
                    searchResults: v1.io.searchResults, 
                    updateSong: v1.io.updateSong, 
                    newSong: new Data_Tuple.Tuple(v.value0.target.value, Data_Function.apply(Data_Either.either(function ($255) {
                        return Data_Either.Left.create(Data_Show.show(Text_Parsing_StringParser.showParseError)($255));
                    })(Data_Either.Right.create))(Text_Parsing_StringParser.runParser(Model.parseSong)(v.value0.target.value)))
                };
                return $32;
            })());
        };
        if (v instanceof UpdateSongChange) {
            return Data_Function.apply(Pux.noEffects)((function () {
                var $42 = {};
                for (var $43 in v1) {
                    if (v1.hasOwnProperty($43)) {
                        $42[$43] = v1[$43];
                    };
                };
                $42.io = {
                    song: v1.io.song, 
                    searchResults: v1.io.searchResults, 
                    newSong: v1.io.newSong, 
                    updateSong: new Data_Tuple.Tuple(v.value0.target.value, Data_Function.apply(Data_Either.either(function ($256) {
                        return Data_Either.Left.create(Data_Show.show(Text_Parsing_StringParser.showParseError)($256));
                    })(Data_Either.Right.create))(Text_Parsing_StringParser.runParser(Model.parseSong)(v.value0.target.value)))
                };
                return $42;
            })());
        };
        if (v instanceof MkSongFullscreen) {
            return {
                state: v1, 
                effects: [ Control_Bind.bind(Control_Monad_Aff.bindAff)(Data_Function.apply(Control_Monad_Eff_Class.liftEff(Control_Monad_Aff.monadEffAff))(Fullscreen.mkSongFullscreen))(function () {
                    return Control_Applicative.pure(Control_Monad_Aff.applicativeAff)(Noop.value);
                }) ]
            };
        };
        if (v instanceof ToggleShowSongMeta) {
            return Data_Function.apply(Pux.noEffects)((function () {
                var $55 = {};
                for (var $56 in v1) {
                    if (v1.hasOwnProperty($56)) {
                        $55[$56] = v1[$56];
                    };
                };
                $55.ui = (function () {
                    var $52 = {};
                    for (var $53 in v1.ui) {
                        if (v1.ui.hasOwnProperty($53)) {
                            $52[$53] = v1.ui[$53];
                        };
                    };
                    $52.showSongMeta = !v1.ui.showSongMeta;
                    return $52;
                })();
                return $55;
            })());
        };
        if (v instanceof ToggleShowDuplicatedChorus) {
            return Data_Function.apply(Pux.noEffects)((function () {
                var $63 = {};
                for (var $64 in v1) {
                    if (v1.hasOwnProperty($64)) {
                        $63[$64] = v1[$64];
                    };
                };
                $63.ui = (function () {
                    var $60 = {};
                    for (var $61 in v1.ui) {
                        if (v1.ui.hasOwnProperty($61)) {
                            $60[$61] = v1.ui[$61];
                        };
                    };
                    $60.showDuplicatedChorus = !v1.ui.showDuplicatedChorus;
                    return $60;
                })();
                return $63;
            })());
        };
        throw new Error("Failed pattern match at Action line 92, column 1 - line 93, column 72: " + [ v.constructor.name, v1.constructor.name ]);
    };
};
var updateSong$prime = function (id) {
    return function (v) {
        return Control_Bind.bind(Control_Monad_Aff.bindAff)(Data_Function.apply(Network_HTTP_Affjax.affjax(Network_HTTP_Affjax_Request.requestableString)(Network_HTTP_Affjax_Response.responsableString))((function () {
            var $70 = {};
            for (var $71 in Network_HTTP_Affjax.defaultRequest) {
                if (Network_HTTP_Affjax.defaultRequest.hasOwnProperty($71)) {
                    $70[$71] = Network_HTTP_Affjax.defaultRequest[$71];
                };
            };
            $70.method = new Data_Either.Left(Data_HTTP_Method.PUT.value);
            $70.url = "/api/song/" + Data_Show.show(Data_Show.showInt)(id);
            $70.content = Data_Function.apply(Data_Maybe.Just.create)(Data_FormURLEncoded.encode(Data_FormURLEncoded.fromArray([ new Data_Tuple.Tuple("song", new Data_Maybe.Just(v)) ])));
            $70.headers = [ new Network_HTTP_RequestHeader.ContentType(Data_MediaType_Common.applicationFormURLEncoded) ];
            return $70;
        })()))(function (v1) {
            return Control_Applicative.pure(Control_Monad_Aff.applicativeAff)((function () {
                if (v1.status === 200) {
                    return Ok.value;
                };
                return new Ko(v1.response);
            })());
        });
    };
};
var postSongEncodeJson = new Data_Argonaut_Encode_Class.EncodeJson(function (v) {
    return Data_Argonaut_Encode_Combinators.extend(Data_Argonaut_Encode_Class.encodeJsonJson)(Data_Argonaut_Encode_Combinators.assoc(Data_Argonaut_Encode_Class.encodeJsonJString)("song")(v))(Data_Argonaut_Core.jsonEmptyObject);
});
var postSong = function (v) {
    return Control_Bind.bind(Control_Monad_Aff.bindAff)(Data_Function.apply(Network_HTTP_Affjax.affjax(Network_HTTP_Affjax_Request.requestableString)(Network_HTTP_Affjax_Response.responsableString))((function () {
        var $77 = {};
        for (var $78 in Network_HTTP_Affjax.defaultRequest) {
            if (Network_HTTP_Affjax.defaultRequest.hasOwnProperty($78)) {
                $77[$78] = Network_HTTP_Affjax.defaultRequest[$78];
            };
        };
        $77.method = new Data_Either.Left(Data_HTTP_Method.POST.value);
        $77.url = "/api/song";
        $77.content = Data_Function.apply(Data_Maybe.Just.create)(Data_FormURLEncoded.encode(Data_FormURLEncoded.fromArray([ new Data_Tuple.Tuple("song", new Data_Maybe.Just(v)) ])));
        $77.headers = [ new Network_HTTP_RequestHeader.ContentType(Data_MediaType_Common.applicationFormURLEncoded) ];
        return $77;
    })()))(function (v1) {
        return Control_Applicative.pure(Control_Monad_Aff.applicativeAff)((function () {
            if (v1.status === 200) {
                var $82 = Data_Foreign_Class.readJSON(Model.isForeignDBSong)(v1.response);
                if ($82 instanceof Data_Either.Right) {
                    return new Data_Either.Right($82.value0);
                };
                if ($82 instanceof Data_Either.Left) {
                    return Data_Function.apply(Data_Either.Left.create)(Data_Show.show(Data_Foreign.showForeignError)($82.value0));
                };
                throw new Error("Failed pattern match at Action line 236, column 29 - line 238, column 54: " + [ $82.constructor.name ]);
            };
            return new Data_Either.Left(v1.response);
        })());
    });
};
var fetchSong = function (id) {
    return Control_Bind.bind(Control_Monad_Aff.bindAff)(Data_Function.apply(Network_HTTP_Affjax.get(Network_HTTP_Affjax_Response.responsableString))("/api/song/" + Data_Show.show(Data_Show.showInt)(id)))(function (v) {
        return Control_Applicative.pure(Control_Monad_Aff.applicativeAff)((function () {
            if (v.status === 200) {
                return v.response;
            };
            return "fail";
        })());
    });
};
var fetchSearch = function (q) {
    return Control_Bind.bind(Control_Monad_Aff.bindAff)(Data_Function.apply(Network_HTTP_Affjax.get(Network_HTTP_Affjax_Response.responsableString))("/api/search?q=" + q))(function (v) {
        return Control_Applicative.pure(Control_Monad_Aff.applicativeAff)((function () {
            if (v.status === 200) {
                return v.response;
            };
            return "fail";
        })());
    });
};
var deleteSong = function (id) {
    return Control_Bind.bind(Control_Monad_Aff.bindAff)(Network_HTTP_Affjax["delete"](Network_HTTP_Affjax_Response.responsableString)("/api/song/" + Data_Show.show(Data_Show.showInt)(id)))(function (v) {
        return Control_Applicative.pure(Control_Monad_Aff.applicativeAff)((function () {
            if (v.status === 204) {
                return Ok.value;
            };
            return new Ko(v.response);
        })());
    });
};
var updateIO = function (v) {
    return function (v1) {
        if (v instanceof RequestSearch) {
            return {
                state: Data_Function.apply(App.State)((function () {
                    var $93 = {};
                    for (var $94 in v1) {
                        if (v1.hasOwnProperty($94)) {
                            $93[$94] = v1[$94];
                        };
                    };
                    $93.io = {
                        searchResults: App.Loading.value, 
                        song: v1.io.song, 
                        newSong: v1.io.newSong, 
                        updateSong: v1.io.updateSong
                    };
                    return $93;
                })()), 
                effects: [ Control_Bind.bind(Control_Monad_Aff.bindAff)(Data_Function.apply(Control_Monad_Eff_Class.liftEff(Control_Monad_Aff.monadEffAff))(Data_Function.apply(Pux_Router.navigateTo)("/search?q=" + v.value0)))(function () {
                    return Control_Bind.bind(Control_Monad_Aff.bindAff)(fetchSearch(v1.ui.searchQuery))(function (v2) {
                        var results = Data_Foreign_Class.readJSON(Data_Foreign_Class.arrayIsForeign(Model.isForeignDBSong))(v2);
                        return Data_Function.apply(Control_Applicative.pure(Control_Monad_Aff.applicativeAff))(Data_Function.apply(IOAction.create)(new ReceiveSearch(results)));
                    });
                }) ]
            };
        };
        if (v instanceof ReceiveSearch && v.value0 instanceof Data_Either.Right) {
            return Data_Function.apply(Pux.noEffects)(Data_Function.apply(App.State)((function () {
                var $104 = {};
                for (var $105 in v1) {
                    if (v1.hasOwnProperty($105)) {
                        $104[$105] = v1[$105];
                    };
                };
                $104.io = {
                    searchResults: new App.Loaded(v.value0.value0), 
                    song: v1.io.song, 
                    newSong: v1.io.newSong, 
                    updateSong: v1.io.updateSong
                };
                return $104;
            })()));
        };
        if (v instanceof ReceiveSearch && v.value0 instanceof Data_Either.Left) {
            return Data_Function.apply(Pux.noEffects)(Data_Function.apply(App.State)((function () {
                var $113 = {};
                for (var $114 in v1) {
                    if (v1.hasOwnProperty($114)) {
                        $113[$114] = v1[$114];
                    };
                };
                $113.io = {
                    searchResults: new App.LoadError(Data_Show.show(Data_Foreign.showForeignError)(v.value0.value0)), 
                    song: v1.io.song, 
                    newSong: v1.io.newSong, 
                    updateSong: v1.io.updateSong
                };
                return $113;
            })()));
        };
        if (v instanceof RequestSong) {
            return {
                state: Data_Function.apply(App.State)((function () {
                    var $122 = {};
                    for (var $123 in v1) {
                        if (v1.hasOwnProperty($123)) {
                            $122[$123] = v1[$123];
                        };
                    };
                    $122.io = {
                        song: App.Loading.value, 
                        searchResults: v1.io.searchResults, 
                        newSong: v1.io.newSong, 
                        updateSong: v1.io.updateSong
                    };
                    return $122;
                })()), 
                effects: [ Control_Bind.bind(Control_Monad_Aff.bindAff)(fetchSong(v.value0))(function (v2) {
                    var song = Data_Foreign_Class.readJSON(Model.isForeignSong)(v2);
                    return Data_Function.apply(Control_Applicative.pure(Control_Monad_Aff.applicativeAff))(Data_Function.apply(IOAction.create)(new ReceiveSong(song)));
                }) ]
            };
        };
        if (v instanceof ReceiveSong && v.value0 instanceof Data_Either.Right) {
            return Data_Function.apply(Pux.noEffects)((function () {
                var $131 = {};
                for (var $132 in v1) {
                    if (v1.hasOwnProperty($132)) {
                        $131[$132] = v1[$132];
                    };
                };
                $131.io = {
                    song: new App.Loaded(v.value0.value0), 
                    searchResults: v1.io.searchResults, 
                    newSong: v1.io.newSong, 
                    updateSong: v1.io.updateSong
                };
                return $131;
            })());
        };
        if (v instanceof ReceiveSong && v.value0 instanceof Data_Either.Left) {
            return Data_Function.apply(Pux.noEffects)((function () {
                var $140 = {};
                for (var $141 in v1) {
                    if (v1.hasOwnProperty($141)) {
                        $140[$141] = v1[$141];
                    };
                };
                $140.io = {
                    song: new App.LoadError(Data_Show.show(Data_Foreign.showForeignError)(v.value0.value0)), 
                    searchResults: v1.io.searchResults, 
                    newSong: v1.io.newSong, 
                    updateSong: v1.io.updateSong
                };
                return $140;
            })());
        };
        if (v instanceof SubmitNewSong && v1.io.newSong.value1 instanceof Data_Either.Right) {
            return {
                state: v1, 
                effects: [ Control_Bind.bind(Control_Monad_Aff.bindAff)(postSong(v1.io.newSong.value0))(function (v2) {
                    return Data_Function.apply(Control_Applicative.pure(Control_Monad_Aff.applicativeAff))(Data_Function.apply(IOAction.create)(new ReceiveSubmitNewSong(v2)));
                }) ]
            };
        };
        if (v instanceof SubmitNewSong) {
            return Pux.noEffects(v1);
        };
        if (v instanceof SubmitUpdateSong && (v1.currentPage instanceof Route.UpdateSongPage && v1.io.updateSong.value1 instanceof Data_Either.Right)) {
            return {
                state: v1, 
                effects: [ Control_Bind.bind(Control_Monad_Aff.bindAff)(updateSong$prime(v1.currentPage.value0)(v1.io.updateSong.value0))(function (v2) {
                    return Data_Function.apply(Control_Applicative.pure(Control_Monad_Aff.applicativeAff))(Data_Function.apply(IOAction.create)(new ReceiveSubmitUpdateSong(v1.currentPage.value0, v2)));
                }) ]
            };
        };
        if (v instanceof SubmitUpdateSong) {
            return Pux.noEffects(v1);
        };
        if (v instanceof SubmitDeleteSong) {
            return {
                state: v1, 
                effects: [ Control_Bind.bind(Control_Monad_Aff.bindAff)(deleteSong(v.value0))(function (v2) {
                    return Data_Function.apply(Control_Applicative.pure(Control_Monad_Aff.applicativeAff))(Data_Function.apply(IOAction.create)(new ReceiveSubmitDeleteSong(v2)));
                }) ]
            };
        };
        if (v instanceof ReceiveSubmitNewSong && v.value0 instanceof Data_Either.Right) {
            return {
                state: (function () {
                    var $168 = {};
                    for (var $169 in v1) {
                        if (v1.hasOwnProperty($169)) {
                            $168[$169] = v1[$169];
                        };
                    };
                    $168.io = (function () {
                        var $165 = {};
                        for (var $166 in v1.io) {
                            if (v1.io.hasOwnProperty($166)) {
                                $165[$166] = v1.io[$166];
                            };
                        };
                        $165.song = new App.Loaded(v.value0.value0.song);
                        return $165;
                    })();
                    return $168;
                })(), 
                effects: [ Control_Bind.bind(Control_Monad_Aff.bindAff)(Data_Function.apply(Control_Monad_Eff_Class.liftEff(Control_Monad_Aff.monadEffAff))(Data_Function.apply(Pux_Router.navigateTo)("/song/" + v.value0.value0.id)))(function () {
                    return Control_Applicative.pure(Control_Monad_Aff.applicativeAff)(Noop.value);
                }) ]
            };
        };
        if (v instanceof ReceiveSubmitNewSong && v.value0 instanceof Data_Either.Left) {
            return Data_Function.apply(Pux.noEffects)((function () {
                var $176 = {};
                for (var $177 in v1) {
                    if (v1.hasOwnProperty($177)) {
                        $176[$177] = v1[$177];
                    };
                };
                $176.io = {
                    searchResults: v1.io.searchResults, 
                    song: v1.io.song, 
                    newSong: new Data_Tuple.Tuple(v1.io.newSong.value0, new Data_Either.Left(v.value0.value0)), 
                    updateSong: v1.io.updateSong
                };
                return $176;
            })());
        };
        if (v instanceof ReceiveSubmitUpdateSong && v.value1 instanceof Ok) {
            return {
                state: v1, 
                effects: [ Control_Bind.bind(Control_Monad_Aff.bindAff)(Data_Function.apply(Control_Monad_Eff_Class.liftEff(Control_Monad_Aff.monadEffAff))(Data_Function.apply(Pux_Router.navigateTo)("/song/" + Data_Show.show(Data_Show.showInt)(v.value0))))(function () {
                    return Control_Applicative.pure(Control_Monad_Aff.applicativeAff)(Noop.value);
                }) ]
            };
        };
        if (v instanceof ReceiveSubmitUpdateSong && v.value1 instanceof Ko) {
            return Data_Function.apply(Pux.noEffects)((function () {
                var $190 = {};
                for (var $191 in v1) {
                    if (v1.hasOwnProperty($191)) {
                        $190[$191] = v1[$191];
                    };
                };
                $190.io = {
                    searchResults: v1.io.searchResults, 
                    song: v1.io.song, 
                    updateSong: new Data_Tuple.Tuple(v1.io.updateSong.value0, new Data_Either.Left(v.value1.value0)), 
                    newSong: v1.io.newSong
                };
                return $190;
            })());
        };
        if (v instanceof ReceiveSubmitDeleteSong && v.value0 instanceof Ok) {
            return {
                state: v1, 
                effects: [ Control_Bind.bind(Control_Monad_Aff.bindAff)(Data_Function.apply(Control_Monad_Eff_Class.liftEff(Control_Monad_Aff.monadEffAff))(Pux_Router.navigateTo("/")))(function () {
                    return Control_Applicative.pure(Control_Monad_Aff.applicativeAff)(Noop.value);
                }) ]
            };
        };
        if (v instanceof ReceiveSubmitDeleteSong && v.value0 instanceof Ko) {
            return Data_Function.apply(Pux.noEffects)((function () {
                var $204 = {};
                for (var $205 in v1) {
                    if (v1.hasOwnProperty($205)) {
                        $204[$205] = v1[$205];
                    };
                };
                $204.io = {
                    searchResults: v1.io.searchResults, 
                    song: v1.io.song, 
                    newSong: new Data_Tuple.Tuple(v1.io.newSong.value0, new Data_Either.Left(v.value0.value0)), 
                    updateSong: v1.io.updateSong
                };
                return $204;
            })());
        };
        throw new Error("Failed pattern match at Action line 118, column 1 - line 126, column 2: " + [ v.constructor.name, v1.constructor.name ]);
    };
};
var updatePage = function (v) {
    return function (v1) {
        if (Data_Eq.eq(Route.eqRoute)(v)(v1.currentPage)) {
            return Data_Function.apply(Pux.noEffects)(v1);
        };
        if (v instanceof Route.SongPage) {
            return updateIO(new RequestSong(v.value0))((function () {
                var $219 = {};
                for (var $220 in v1) {
                    if (v1.hasOwnProperty($220)) {
                        $219[$220] = v1[$220];
                    };
                };
                $219.currentPage = v;
                return $219;
            })());
        };
        if (v instanceof Route.SearchResultPage) {
            return updateIO(new RequestSearch(v.value0))((function () {
                var $226 = {};
                for (var $227 in v1) {
                    if (v1.hasOwnProperty($227)) {
                        $226[$227] = v1[$227];
                    };
                };
                $226.currentPage = v;
                $226.ui = (function () {
                    var $223 = {};
                    for (var $224 in v1.ui) {
                        if (v1.ui.hasOwnProperty($224)) {
                            $223[$224] = v1.ui[$224];
                        };
                    };
                    $223.searchQuery = v.value0;
                    return $223;
                })();
                return $226;
            })());
        };
        if (v instanceof Route.UpdateSongPage && v1.io.song instanceof App.Loaded) {
            return Data_Function.apply(Pux.noEffects)((function () {
                var $231 = {};
                for (var $232 in v1) {
                    if (v1.hasOwnProperty($232)) {
                        $231[$232] = v1[$232];
                    };
                };
                $231.currentPage = v;
                $231.io = {
                    updateSong: new Data_Tuple.Tuple(Model.serializeSong(v1.io.song.value0), new Data_Either.Right(v1.io.song.value0)), 
                    song: v1.io.song, 
                    searchResults: v1.io.searchResults, 
                    newSong: v1.io.newSong
                };
                return $231;
            })());
        };
        if (v instanceof Route.NewSongPage) {
            return Data_Function.apply(Pux.noEffects)((function () {
                var $243 = {};
                for (var $244 in v1) {
                    if (v1.hasOwnProperty($244)) {
                        $243[$244] = v1[$244];
                    };
                };
                $243.currentPage = v;
                $243.io = (function () {
                    var $240 = {};
                    for (var $241 in v1.io) {
                        if (v1.io.hasOwnProperty($241)) {
                            $240[$241] = v1.io[$241];
                        };
                    };
                    $240.newSong = new Data_Tuple.Tuple(Model.serializeSong(Model.exampleSong), new Data_Either.Right(Model.exampleSong));
                    return $240;
                })();
                return $243;
            })());
        };
        return Data_Function.apply(Pux.noEffects)((function () {
            var $247 = {};
            for (var $248 in v1) {
                if (v1.hasOwnProperty($248)) {
                    $247[$248] = v1[$248];
                };
            };
            $247.currentPage = v;
            return $247;
        })());
    };
};
var update = function (v) {
    return function (state) {
        if (v instanceof PageView) {
            return updatePage(v.value0)(state);
        };
        if (v instanceof IOAction) {
            return updateIO(v.value0)(state);
        };
        if (v instanceof UIAction) {
            return updateUI(v.value0)(state);
        };
        if (v instanceof Noop) {
            return Pux.noEffects(state);
        };
        throw new Error("Failed pattern match at Action line 67, column 1 - line 67, column 47: " + [ v.constructor.name, state.constructor.name ]);
    };
};
module.exports = {
    IOAction: IOAction, 
    UIAction: UIAction, 
    PageView: PageView, 
    Noop: Noop, 
    RequestSong: RequestSong, 
    ReceiveSong: ReceiveSong, 
    RequestSearch: RequestSearch, 
    ReceiveSearch: ReceiveSearch, 
    SubmitNewSong: SubmitNewSong, 
    SubmitUpdateSong: SubmitUpdateSong, 
    SubmitDeleteSong: SubmitDeleteSong, 
    ReceiveSubmitNewSong: ReceiveSubmitNewSong, 
    ReceiveSubmitUpdateSong: ReceiveSubmitUpdateSong, 
    ReceiveSubmitDeleteSong: ReceiveSubmitDeleteSong, 
    Ok: Ok, 
    Ko: Ko, 
    PostSong: PostSong, 
    SearchChange: SearchChange, 
    NewSongChange: NewSongChange, 
    UpdateSongChange: UpdateSongChange, 
    MkSongFullscreen: MkSongFullscreen, 
    ToggleShowSongMeta: ToggleShowSongMeta, 
    ToggleShowDuplicatedChorus: ToggleShowDuplicatedChorus, 
    deleteSong: deleteSong, 
    fetchSearch: fetchSearch, 
    fetchSong: fetchSong, 
    postSong: postSong, 
    update: update, 
    updateIO: updateIO, 
    updatePage: updatePage, 
    "updateSong'": updateSong$prime, 
    updateUI: updateUI, 
    postSongEncodeJson: postSongEncodeJson
};

// Generated by psc version 0.9.3
"use strict";
var $foreign = require("./foreign");
var Prelude = require("../Prelude");
var Data_Foreign = require("../Data.Foreign");
var Data_Foreign_Class = require("../Data.Foreign.Class");
var Data_Function_Uncurried = require("../Data.Function.Uncurried");
var Data_Either = require("../Data.Either");
var Data_Maybe = require("../Data.Maybe");
var Control_Monad_Eff_Class = require("../Control.Monad.Eff.Class");
var Node_Express_Handler = require("../Node.Express.Handler");
var Node_Express_Types = require("../Node.Express.Types");
var Node_Express_Internal_Utils = require("../Node.Express.Internal.Utils");
var Node_Express_Internal_QueryString = require("../Node.Express.Internal.QueryString");
var Control_Bind = require("../Control.Bind");
var Control_Monad_Eff = require("../Control.Monad.Eff");
var Control_Applicative = require("../Control.Applicative");
var Data_Function = require("../Data.Function");
var Control_Monad_Aff = require("../Control.Monad.Aff");
var Control_Monad = require("../Control.Monad");
var Control_Semigroupoid = require("../Control.Semigroupoid");
var queryParams = function (req) {
    return function __do() {
        var v = $foreign._getQueryParams(req)();
        var $56 = Node_Express_Internal_QueryString.parse(v);
        if ($56 instanceof Data_Either.Left) {
            return [  ];
        };
        if ($56 instanceof Data_Either.Right) {
            return $56.value0;
        };
        throw new Error("Failed pattern match at Node.Express.Request line 167, column 5 - line 169, column 36: " + [ $56.constructor.name ]);
    };
};
var isXhr = new Node_Express_Handler.HandlerM(function (req) {
    return function (v) {
        return function (v1) {
            return Data_Function.apply(Control_Monad_Eff_Class.liftEff(Control_Monad_Aff.monadEffAff))($foreign._isXhr(req));
        };
    };
});
var isStale = new Node_Express_Handler.HandlerM(function (req) {
    return function (v) {
        return function (v1) {
            return Data_Function.apply(Control_Monad_Eff_Class.liftEff(Control_Monad_Aff.monadEffAff))($foreign._isStale(req));
        };
    };
});
var isFresh = new Node_Express_Handler.HandlerM(function (req) {
    return function (v) {
        return function (v1) {
            return Data_Function.apply(Control_Monad_Eff_Class.liftEff(Control_Monad_Aff.monadEffAff))($foreign._isFresh(req));
        };
    };
});
var hasType = function (type_) {
    return new Node_Express_Handler.HandlerM(function (req) {
        return function (v) {
            return function (v1) {
                return Control_Bind.bind(Control_Monad_Aff.bindAff)(Data_Function.apply(Control_Monad_Eff_Class.liftEff(Control_Monad_Aff.monadEffAff))(Control_Monad.liftM1(Control_Monad_Eff.monadEff)(function ($111) {
                    return Node_Express_Internal_Utils.eitherToMaybe(Data_Foreign_Class.read(Data_Foreign_Class.booleanIsForeign)($111));
                })($foreign._hasType(req, type_))))(function (v2) {
                    return Data_Function.apply(Control_Applicative.pure(Control_Monad_Aff.applicativeAff))(Data_Maybe.fromMaybe(false)(v2));
                });
            };
        };
    });
};
var getUrl = new Node_Express_Handler.HandlerM(function (req) {
    return function (v) {
        return function (v1) {
            return Data_Function.apply(Control_Monad_Eff_Class.liftEff(Control_Monad_Aff.monadEffAff))($foreign._getUrl(req));
        };
    };
});
var getSubdomains = new Node_Express_Handler.HandlerM(function (req) {
    return function (v) {
        return function (v1) {
            return Data_Function.apply(Control_Monad_Eff_Class.liftEff(Control_Monad_Aff.monadEffAff))($foreign._getSubdomains(req));
        };
    };
});
var getSignedCookie = function (name) {
    return new Node_Express_Handler.HandlerM(function (req) {
        return function (v) {
            return function (v1) {
                return Data_Function.apply(Control_Monad_Eff_Class.liftEff(Control_Monad_Aff.monadEffAff))(Control_Monad.liftM1(Control_Monad_Eff.monadEff)(function ($112) {
                    return Node_Express_Internal_Utils.eitherToMaybe(Data_Foreign_Class.read(Data_Foreign_Class.stringIsForeign)($112));
                })($foreign._getSignedCookie(req, name)));
            };
        };
    });
};
var getRouteParam = function (dictRequestParam) {
    return function (name) {
        return new Node_Express_Handler.HandlerM(function (req) {
            return function (v) {
                return function (v1) {
                    return Data_Function.apply(Control_Monad_Eff_Class.liftEff(Control_Monad_Aff.monadEffAff))(Control_Monad.liftM1(Control_Monad_Eff.monadEff)(function ($113) {
                        return Node_Express_Internal_Utils.eitherToMaybe(Data_Foreign_Class.read(Data_Foreign_Class.stringIsForeign)($113));
                    })($foreign._getRouteParam(req, name)));
                };
            };
        });
    };
};
var getRoute = new Node_Express_Handler.HandlerM(function (req) {
    return function (v) {
        return function (v1) {
            return Data_Function.apply(Control_Monad_Eff_Class.liftEff(Control_Monad_Aff.monadEffAff))($foreign._getRoute(req));
        };
    };
});
var getRequestHeader = function (field) {
    return new Node_Express_Handler.HandlerM(function (req) {
        return function (v) {
            return function (v1) {
                return Data_Function.apply(Control_Monad_Eff_Class.liftEff(Control_Monad_Aff.monadEffAff))(Control_Monad.liftM1(Control_Monad_Eff.monadEff)(function ($114) {
                    return Node_Express_Internal_Utils.eitherToMaybe(Data_Foreign_Class.read(Data_Foreign_Class.stringIsForeign)($114));
                })($foreign._getHeader(req, field)));
            };
        };
    });
};
var getRemoteIps = new Node_Express_Handler.HandlerM(function (req) {
    return function (v) {
        return function (v1) {
            return Data_Function.apply(Control_Monad_Eff_Class.liftEff(Control_Monad_Aff.monadEffAff))($foreign._getRemoteIps(req));
        };
    };
});
var getRemoteIp = new Node_Express_Handler.HandlerM(function (req) {
    return function (v) {
        return function (v1) {
            return Data_Function.apply(Control_Monad_Eff_Class.liftEff(Control_Monad_Aff.monadEffAff))($foreign._getRemoteIp(req));
        };
    };
});
var getQueryParams = function (name) {
    return new Node_Express_Handler.HandlerM(function (req) {
        return function (v) {
            return function (v1) {
                return Control_Bind.bind(Control_Monad_Aff.bindAff)(Data_Function.apply(Control_Monad_Eff_Class.liftEff(Control_Monad_Aff.monadEffAff))(queryParams(req)))(function (v2) {
                    return Data_Function.apply(Control_Applicative.pure(Control_Monad_Aff.applicativeAff))(Node_Express_Internal_QueryString.getAll(v2)(name));
                });
            };
        };
    });
};
var getQueryParam = function (name) {
    return new Node_Express_Handler.HandlerM(function (req) {
        return function (v) {
            return function (v1) {
                return Control_Bind.bind(Control_Monad_Aff.bindAff)(Data_Function.apply(Control_Monad_Eff_Class.liftEff(Control_Monad_Aff.monadEffAff))(queryParams(req)))(function (v2) {
                    return Data_Function.apply(Control_Applicative.pure(Control_Monad_Aff.applicativeAff))(Node_Express_Internal_QueryString.getOne(v2)(name));
                });
            };
        };
    });
};
var getProtocol = new Node_Express_Handler.HandlerM(function (req) {
    return function (v) {
        return function (v1) {
            return Data_Function.apply(Control_Monad_Eff_Class.liftEff(Control_Monad_Aff.monadEffAff))(Control_Monad.liftM1(Control_Monad_Eff.monadEff)(function ($115) {
                return Node_Express_Internal_Utils.eitherToMaybe(Data_Foreign_Class.read(Node_Express_Types.isForeignProtocol)($115));
            })($foreign._getProtocol(req)));
        };
    };
});
var getPath = new Node_Express_Handler.HandlerM(function (req) {
    return function (v) {
        return function (v1) {
            return Data_Function.apply(Control_Monad_Eff_Class.liftEff(Control_Monad_Aff.monadEffAff))($foreign._getPath(req));
        };
    };
});
var getOriginalUrl = new Node_Express_Handler.HandlerM(function (req) {
    return function (v) {
        return function (v1) {
            return Data_Function.apply(Control_Monad_Eff_Class.liftEff(Control_Monad_Aff.monadEffAff))($foreign._getOriginalUrl(req));
        };
    };
});
var getMethod = new Node_Express_Handler.HandlerM(function (req) {
    return function (v) {
        return function (v1) {
            return Data_Function.apply(Control_Monad_Eff_Class.liftEff(Control_Monad_Aff.monadEffAff))(Control_Monad.liftM1(Control_Monad_Eff.monadEff)(function ($116) {
                return Node_Express_Internal_Utils.eitherToMaybe(Data_Foreign_Class.read(Node_Express_Types.isForeignMethod)($116));
            })($foreign._getMethod(req)));
        };
    };
});
var getHostname = new Node_Express_Handler.HandlerM(function (req) {
    return function (v) {
        return function (v1) {
            return Data_Function.apply(Control_Monad_Eff_Class.liftEff(Control_Monad_Aff.monadEffAff))($foreign._getHostname(req));
        };
    };
});
var getCookie = function (name) {
    return new Node_Express_Handler.HandlerM(function (req) {
        return function (v) {
            return function (v1) {
                return Data_Function.apply(Control_Monad_Eff_Class.liftEff(Control_Monad_Aff.monadEffAff))(Control_Monad.liftM1(Control_Monad_Eff.monadEff)(function ($117) {
                    return Node_Express_Internal_Utils.eitherToMaybe(Data_Foreign_Class.read(Data_Foreign_Class.stringIsForeign)($117));
                })($foreign._getCookie(req, name)));
            };
        };
    });
};
var getBodyParam = function (dictIsForeign) {
    return function (name) {
        return new Node_Express_Handler.HandlerM(function (req) {
            return function (v) {
                return function (v1) {
                    return Data_Function.apply(Control_Monad_Eff_Class.liftEff(Control_Monad_Aff.monadEffAff))(Control_Monad.liftM1(Control_Monad_Eff.monadEff)(function ($118) {
                        return Node_Express_Internal_Utils.eitherToMaybe(Data_Foreign_Class.read(dictIsForeign)($118));
                    })($foreign._getBodyParam(req, name)));
                };
            };
        });
    };
};
var acceptsLanguage = function (language) {
    return new Node_Express_Handler.HandlerM(function (req) {
        return function (v) {
            return function (v1) {
                return Data_Function.apply(Control_Monad_Eff_Class.liftEff(Control_Monad_Aff.monadEffAff))(Control_Monad.liftM1(Control_Monad_Eff.monadEff)(function ($119) {
                    return Node_Express_Internal_Utils.eitherToMaybe(Data_Foreign_Class.read(Data_Foreign_Class.stringIsForeign)($119));
                })($foreign._acceptsLanguage(req, language)));
            };
        };
    });
};
var acceptsCharset = function (charset) {
    return new Node_Express_Handler.HandlerM(function (req) {
        return function (v) {
            return function (v1) {
                return Data_Function.apply(Control_Monad_Eff_Class.liftEff(Control_Monad_Aff.monadEffAff))(Control_Monad.liftM1(Control_Monad_Eff.monadEff)(function ($120) {
                    return Node_Express_Internal_Utils.eitherToMaybe(Data_Foreign_Class.read(Data_Foreign_Class.stringIsForeign)($120));
                })($foreign._acceptsCharset(req, charset)));
            };
        };
    });
};
var accepts = function (types) {
    return new Node_Express_Handler.HandlerM(function (req) {
        return function (v) {
            return function (v1) {
                return Data_Function.apply(Control_Monad_Eff_Class.liftEff(Control_Monad_Aff.monadEffAff))(Control_Monad.liftM1(Control_Monad_Eff.monadEff)(function ($121) {
                    return Node_Express_Internal_Utils.eitherToMaybe(Data_Foreign_Class.read(Data_Foreign_Class.stringIsForeign)($121));
                })($foreign._accepts(req, types)));
            };
        };
    });
};
var ifAccepts = function (type_) {
    return function (act) {
        return Control_Bind.bind(Node_Express_Handler.bindHandlerM)(Data_Function.apply(Control_Monad.liftM1(Node_Express_Handler.monadHandlerM)(Data_Maybe.maybe(false)(Data_Function["const"](true))))(accepts(type_)))(function (v) {
            return Control_Applicative.when(Node_Express_Handler.applicativeHandlerM)(v)(act);
        });
    };
};
module.exports = {
    accepts: accepts, 
    acceptsCharset: acceptsCharset, 
    acceptsLanguage: acceptsLanguage, 
    getBodyParam: getBodyParam, 
    getCookie: getCookie, 
    getHostname: getHostname, 
    getMethod: getMethod, 
    getOriginalUrl: getOriginalUrl, 
    getPath: getPath, 
    getProtocol: getProtocol, 
    getQueryParam: getQueryParam, 
    getQueryParams: getQueryParams, 
    getRemoteIp: getRemoteIp, 
    getRemoteIps: getRemoteIps, 
    getRequestHeader: getRequestHeader, 
    getRoute: getRoute, 
    getRouteParam: getRouteParam, 
    getSignedCookie: getSignedCookie, 
    getSubdomains: getSubdomains, 
    getUrl: getUrl, 
    hasType: hasType, 
    ifAccepts: ifAccepts, 
    isFresh: isFresh, 
    isStale: isStale, 
    isXhr: isXhr
};
